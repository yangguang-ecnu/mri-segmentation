/*************************************************************************************************
 *
 * Copyright (c) September 22, 2005
 * Ken Museth
 * Linköping University, Sweden.
 *
 *************************************************************************************************
 * Contributors:  
 *                  1) Ken Museth
 *************************************************************************************************
 *
 *
 *************************************************************************************************/

#ifndef MC_H
#define MC_H


class MC
{
 private:
  static int mBits[8];// lookup table of usefull bits
  static int mTable[][3];// MC vertex table
  static int mOffset[257];//pointers into vertex table
  static int mVtxIndex[8][3];//indices of voxel vertices
  static int mEdges[12][3];//define voxel edges and orientation
 public:
  static int bit(int i)      {return mBits[i];}
  static int X(int iVertex)  {return mVtxIndex[iVertex][0];}
  static int Y(int iVertex)  {return mVtxIndex[iVertex][1];}
  static int Z(int iVertex)  {return mVtxIndex[iVertex][2];}
  static int first(int iCase){return mOffset[iCase];}
  static int last(int iCase) {return mOffset[iCase+1];}
  static int nTri(int iCase) {return mOffset[iCase+1]-mOffset[iCase];}
  static int* Vtx(int iTri)  {return mTable[iTri];}
  static int EdgeVtx1(int iEdge) {return mEdges[iEdge][0];}// 1'th vertex of voxel edge
  static int EdgeVtx2(int iEdge) {return mEdges[iEdge][1];}// 2'nd vertex of voxel edge
  static int EdgeAxis(int iEdge) {return mEdges[iEdge][2];}// axis direction of voxel edge
};
//Off-sets lables of the 8 vertices
int MC::mVtxIndex[8][3]={{0,0,0},{0,1,0},{1,1,0},{1,0,0},
		         {0,0,1},{0,1,1},{1,1,1},{1,0,1}};
// Define vertices (x,y) and direction (z) of the 12 edges of the voxel.
int MC::mEdges[12][3]={{0,1,1},{1,2,0},{3,2,1},{0,3,0},{4,5,1},{5,6,0},
		       {7,6,1},{4,7,0},{0,4,2},{1,5,2},{3,7,2},{2,6,2}};
//offset pointing to first vertex of a MC case in vertex table
// element 257 is a dummy element need by last(iCase)
// note that first and last case have no triangles!
int MC::mOffset[257] = 
{
  0,0,1,2,4,5,7,9,12,13,15,17,20,22,25,28,30,31,33,35,38,40,
  43,46,50,52,55,58,62,65,69,73,76,77,79,81,84,86,89,92,96,
  98,101,104,108,111,115,119,122,124,127,130,132,135,139,143,
  146,149,153,157,160,164,169,174,176,177,179,181,184,186,189,
  192,196,198,201,204,208,211,215,219,222,224,227,230,234,237,
  241,245,250,253,257,261,266,270,275,280,284,286,289,292,296,
  299,303,305,308,311,315,319,324,328,333,336,338,341,345,349,
  352,356,361,364,366,370,375,380,384,389,391,395,396,397,399,
  401,404,406,409,412,416,418,421,424,428,431,435,439,442,444,
  447,450,454,457,461,465,470,473,475,479,482,486,489,494,496,
  498,501,504,508,511,515,519,524,527,531,535,540,544,549,554,
  558,561,565,569,572,576,581,586,590,594,597,602,604,609,613,
  615,616,618,621,624,628,631,635,639,644,647,651,655,660,662,
  665,668,670,673,677,681,686,690,695,700,702,706,709,714,718,
  721,723,727,728,731,735,739,744,748,753,756,760,764,769,774,
  776,779,783,785,786,788,791,794,796,799,803,805,806,809,811,
  815,816,818,819,820,820
};
// Triangle MC cases (pr line) comprised of triplets of crossed voxel edges
// First line is case 1 and last line is case 255
int MC::mTable[][3] = {
  {0,3,8},
  {0,9,1},
  {1,3,8},{9,1,8},
  {1,11,2},
  {0,3,8},{1,11,2},
  {9,11,2},{0,9,2},
  {2,3,8},{2,8,11},{11,8,9},
  {3,2,10},
  {0,2,10},{8,0,10},
  {1,0,9},{2,10,3},
  {1,2,10},{1,10,9},{9,10,8},
  {3,1,11},{10,3,11},
  {0,1,11},{0,11,8},{8,11,10},
  {3,0,9},{3,9,10},{10,9,11},
  {9,11,8},{11,10,8},
  {4,8,7},
  {4,0,3},{7,4,3},
  {0,9,1},{8,7,4},
  {4,9,1},{4,1,7},{7,1,3},
  {1,11,2},{8,7,4},
  {3,7,4},{3,4,0},{1,11,2},
  {9,11,2},{9,2,0},{8,7,4},
  {2,9,11},{2,7,9},{2,3,7},{7,4,9},
  {8,7,4},{3,2,10},
  {10,7,4},{10,4,2},{2,4,0},
  {9,1,0},{8,7,4},{2,10,3},
  {4,10,7},{9,10,4},{9,2,10},{9,1,2},
  {3,1,11},{3,11,10},{7,4,8},
  {1,11,10},{1,10,4},{1,4,0},{7,4,10},
  {4,8,7},{9,10,0},{9,11,10},{10,3,0},
  {4,10,7},{4,9,10},{9,11,10},
  {9,4,5},
  {9,4,5},{0,3,8},
  {0,4,5},{1,0,5},
  {8,4,5},{8,5,3},{3,5,1},
  {1,11,2},{9,4,5},
  {3,8,0},{1,11,2},{4,5,9},
  {5,11,2},{5,2,4},{4,2,0},
  {2,5,11},{3,5,2},{3,4,5},{3,8,4},
  {9,4,5},{2,10,3},
  {0,2,10},{0,10,8},{4,5,9},
  {0,4,5},{0,5,1},{2,10,3},
  {2,5,1},{2,8,5},{2,10,8},{4,5,8},
  {11,10,3},{11,3,1},{9,4,5},
  {4,5,9},{0,1,8},{8,1,11},{8,11,10},
  {5,0,4},{5,10,0},{5,11,10},{10,3,0},
  {5,8,4},{5,11,8},{11,10,8},
  {9,8,7},{5,9,7},
  {9,0,3},{9,3,5},{5,3,7},
  {0,8,7},{0,7,1},{1,7,5},
  {1,3,5},{3,7,5},
  {9,8,7},{9,7,5},{11,2,1},
  {11,2,1},{9,0,5},{5,0,3},{5,3,7},
  {8,2,0},{8,5,2},{8,7,5},{11,2,5},
  {2,5,11},{2,3,5},{3,7,5},
  {7,5,9},{7,9,8},{3,2,10},
  {9,7,5},{9,2,7},{9,0,2},{2,10,7},
  {2,10,3},{0,8,1},{1,8,7},{1,7,5},
  {10,1,2},{10,7,1},{7,5,1},
  {9,8,5},{8,7,5},{11,3,1},{11,10,3},
  {5,0,7},{5,9,0},{7,0,10},{1,11,0},{10,0,11},
  {10,0,11},{10,3,0},{11,0,5},{8,7,0},{5,0,7},
  {10,5,11},{7,5,10},
  {11,5,6},
  {0,3,8},{5,6,11},
  {9,1,0},{5,6,11},
  {1,3,8},{1,8,9},{5,6,11},
  {1,5,6},{2,1,6},
  {1,5,6},{1,6,2},{3,8,0},
  {9,5,6},{9,6,0},{0,6,2},
  {5,8,9},{5,2,8},{5,6,2},{3,8,2},
  {2,10,3},{11,5,6},
  {10,8,0},{10,0,2},{11,5,6},
  {0,9,1},{2,10,3},{5,6,11},
  {5,6,11},{1,2,9},{9,2,10},{9,10,8},
  {6,10,3},{6,3,5},{5,3,1},
  {0,10,8},{0,5,10},{0,1,5},{5,6,10},
  {3,6,10},{0,6,3},{0,5,6},{0,9,5},
  {6,9,5},{6,10,9},{10,8,9},
  {5,6,11},{4,8,7},
  {4,0,3},{4,3,7},{6,11,5},
  {1,0,9},{5,6,11},{8,7,4},
  {11,5,6},{1,7,9},{1,3,7},{7,4,9},
  {6,2,1},{6,1,5},{4,8,7},
  {1,5,2},{5,6,2},{3,4,0},{3,7,4},
  {8,7,4},{9,5,0},{0,5,6},{0,6,2},
  {7,9,3},{7,4,9},{3,9,2},{5,6,9},{2,9,6},
  {3,2,10},{7,4,8},{11,5,6},
  {5,6,11},{4,2,7},{4,0,2},{2,10,7},
  {0,9,1},{4,8,7},{2,10,3},{5,6,11},
  {9,1,2},{9,2,10},{9,10,4},{7,4,10},{5,6,11},
  {8,7,4},{3,5,10},{3,1,5},{5,6,10},
  {5,10,1},{5,6,10},{1,10,0},{7,4,10},{0,10,4},
  {0,9,5},{0,5,6},{0,6,3},{10,3,6},{8,7,4},
  {6,9,5},{6,10,9},{4,9,7},{7,9,10},
  {11,9,4},{6,11,4},
  {4,6,11},{4,11,9},{0,3,8},
  {11,1,0},{11,0,6},{6,0,4},
  {8,1,3},{8,6,1},{8,4,6},{6,11,1},
  {1,9,4},{1,4,2},{2,4,6},
  {3,8,0},{1,9,2},{2,9,4},{2,4,6},
  {0,4,2},{4,6,2},
  {8,2,3},{8,4,2},{4,6,2},
  {11,9,4},{11,4,6},{10,3,2},
  {0,2,8},{2,10,8},{4,11,9},{4,6,11},
  {3,2,10},{0,6,1},{0,4,6},{6,11,1},
  {6,1,4},{6,11,1},{4,1,8},{2,10,1},{8,1,10},
  {9,4,6},{9,6,3},{9,3,1},{10,3,6},
  {8,1,10},{8,0,1},{10,1,6},{9,4,1},{6,1,4},
  {3,6,10},{3,0,6},{0,4,6},
  {6,8,4},{10,8,6},
  {7,6,11},{7,11,8},{8,11,9},
  {0,3,7},{0,7,11},{0,11,9},{6,11,7},
  {11,7,6},{1,7,11},{1,8,7},{1,0,8},
  {11,7,6},{11,1,7},{1,3,7},
  {1,6,2},{1,8,6},{1,9,8},{8,7,6},
  {2,9,6},{2,1,9},{6,9,7},{0,3,9},{7,9,3},
  {7,0,8},{7,6,0},{6,2,0},
  {7,2,3},{6,2,7},
  {2,10,3},{11,8,6},{11,9,8},{8,7,6},
  {2,7,0},{2,10,7},{0,7,9},{6,11,7},{9,7,11},
  {1,0,8},{1,8,7},{1,7,11},{6,11,7},{2,10,3},
  {10,1,2},{10,7,1},{11,1,6},{6,1,7},
  {8,6,9},{8,7,6},{9,6,1},{10,3,6},{1,6,3},
  {0,1,9},{10,7,6},
  {7,0,8},{7,6,0},{3,0,10},{10,0,6},
  {7,6,10},
  {7,10,6},
  {3,8,0},{10,6,7},
  {0,9,1},{10,6,7},
  {8,9,1},{8,1,3},{10,6,7},
  {11,2,1},{6,7,10},
  {1,11,2},{3,8,0},{6,7,10},
  {2,0,9},{2,9,11},{6,7,10},
  {6,7,10},{2,3,11},{11,3,8},{11,8,9},
  {7,3,2},{6,7,2},
  {7,8,0},{7,0,6},{6,0,2},
  {2,6,7},{2,7,3},{0,9,1},
  {1,2,6},{1,6,8},{1,8,9},{8,6,7},
  {11,6,7},{11,7,1},{1,7,3},
  {11,6,7},{1,11,7},{1,7,8},{1,8,0},
  {0,7,3},{0,11,7},{0,9,11},{6,7,11},
  {7,11,6},{7,8,11},{8,9,11},
  {6,4,8},{10,6,8},
  {3,10,6},{3,6,0},{0,6,4},
  {8,10,6},{8,6,4},{9,1,0},
  {9,6,4},{9,3,6},{9,1,3},{10,6,3},
  {6,4,8},{6,8,10},{2,1,11},
  {1,11,2},{3,10,0},{0,10,6},{0,6,4},
  {4,8,10},{4,10,6},{0,9,2},{2,9,11},
  {11,3,9},{11,2,3},{9,3,4},{10,6,3},{4,3,6},
  {8,3,2},{8,2,4},{4,2,6},
  {0,2,4},{4,2,6},
  {1,0,9},{2,4,3},{2,6,4},{4,8,3},
  {1,4,9},{1,2,4},{2,6,4},
  {8,3,1},{8,1,6},{8,6,4},{6,1,11},
  {11,0,1},{11,6,0},{6,4,0},
  {4,3,6},{4,8,3},{6,3,11},{0,9,3},{11,3,9},
  {11,4,9},{6,4,11},
  {4,5,9},{7,10,6},
  {0,3,8},{4,5,9},{10,6,7},
  {5,1,0},{5,0,4},{7,10,6},
  {10,6,7},{8,4,3},{3,4,5},{3,5,1},
  {9,4,5},{11,2,1},{7,10,6},
  {6,7,10},{1,11,2},{0,3,8},{4,5,9},
  {7,10,6},{5,11,4},{4,11,2},{4,2,0},
  {3,8,4},{3,4,5},{3,5,2},{11,2,5},{10,6,7},
  {7,3,2},{7,2,6},{5,9,4},
  {9,4,5},{0,6,8},{0,2,6},{6,7,8},
  {3,2,6},{3,6,7},{1,0,5},{5,0,4},
  {6,8,2},{6,7,8},{2,8,1},{4,5,8},{1,8,5},
  {9,4,5},{11,6,1},{1,6,7},{1,7,3},
  {1,11,6},{1,6,7},{1,7,0},{8,0,7},{9,4,5},
  {4,11,0},{4,5,11},{0,11,3},{6,7,11},{3,11,7},
  {7,11,6},{7,8,11},{5,11,4},{4,11,8},
  {6,5,9},{6,9,10},{10,9,8},
  {3,10,6},{0,3,6},{0,6,5},{0,5,9},
  {0,8,10},{0,10,5},{0,5,1},{5,10,6},
  {6,3,10},{6,5,3},{5,1,3},
  {1,11,2},{9,10,5},{9,8,10},{10,6,5},
  {0,3,10},{0,10,6},{0,6,9},{5,9,6},{1,11,2},
  {10,5,8},{10,6,5},{8,5,0},{11,2,5},{0,5,2},
  {6,3,10},{6,5,3},{2,3,11},{11,3,5},
  {5,9,8},{5,8,2},{5,2,6},{3,2,8},
  {9,6,5},{9,0,6},{0,2,6},
  {1,8,5},{1,0,8},{5,8,6},{3,2,8},{6,8,2},
  {1,6,5},{2,6,1},
  {1,6,3},{1,11,6},{3,6,8},{5,9,6},{8,6,9},
  {11,0,1},{11,6,0},{9,0,5},{5,0,6},
  {0,8,3},{5,11,6},
  {11,6,5},
  {10,11,5},{7,10,5},
  {10,11,5},{10,5,7},{8,0,3},
  {5,7,10},{5,10,11},{1,0,9},
  {11,5,7},{11,7,10},{9,1,8},{8,1,3},
  {10,2,1},{10,1,7},{7,1,5},
  {0,3,8},{1,7,2},{1,5,7},{7,10,2},
  {9,5,7},{9,7,2},{9,2,0},{2,7,10},
  {7,2,5},{7,10,2},{5,2,9},{3,8,2},{9,2,8},
  {2,11,5},{2,5,3},{3,5,7},
  {8,0,2},{8,2,5},{8,5,7},{11,5,2},
  {9,1,0},{5,3,11},{5,7,3},{3,2,11},
  {9,2,8},{9,1,2},{8,2,7},{11,5,2},{7,2,5},
  {1,5,3},{3,5,7},
  {0,7,8},{0,1,7},{1,5,7},
  {9,3,0},{9,5,3},{5,7,3},
  {9,7,8},{5,7,9},
  {5,4,8},{5,8,11},{11,8,10},
  {5,4,0},{5,0,10},{5,10,11},{10,0,3},
  {0,9,1},{8,11,4},{8,10,11},{11,5,4},
  {11,4,10},{11,5,4},{10,4,3},{9,1,4},{3,4,1},
  {2,1,5},{2,5,8},{2,8,10},{4,8,5},
  {0,10,4},{0,3,10},{4,10,5},{2,1,10},{5,10,1},
  {0,5,2},{0,9,5},{2,5,10},{4,8,5},{10,5,8},
  {9,5,4},{2,3,10},
  {2,11,5},{3,2,5},{3,5,4},{3,4,8},
  {5,2,11},{5,4,2},{4,0,2},
  {3,2,11},{3,11,5},{3,5,8},{4,8,5},{0,9,1},
  {5,2,11},{5,4,2},{1,2,9},{9,2,4},
  {8,5,4},{8,3,5},{3,1,5},
  {0,5,4},{1,5,0},
  {8,5,4},{8,3,5},{9,5,0},{0,5,3},
  {9,5,4},
  {4,7,10},{4,10,9},{9,10,11},
  {0,3,8},{4,7,9},{9,7,10},{9,10,11},
  {1,10,11},{1,4,10},{1,0,4},{7,10,4},
  {3,4,1},{3,8,4},{1,4,11},{7,10,4},{11,4,10},
  {4,7,10},{9,4,10},{9,10,2},{9,2,1},
  {9,4,7},{9,7,10},{9,10,1},{2,1,10},{0,3,8},
  {10,4,7},{10,2,4},{2,0,4},
  {10,4,7},{10,2,4},{8,4,3},{3,4,2},
  {2,11,9},{2,9,7},{2,7,3},{7,9,4},
  {9,7,11},{9,4,7},{11,7,2},{8,0,7},{2,7,0},
  {3,11,7},{3,2,11},{7,11,4},{1,0,11},{4,11,0},
  {1,2,11},{8,4,7},
  {4,1,9},{4,7,1},{7,3,1},
  {4,1,9},{4,7,1},{0,1,8},{8,1,7},
  {4,3,0},{7,3,4},
  {4,7,8},
  {9,8,11},{11,8,10},
  {3,9,0},{3,10,9},{10,11,9},
  {0,11,1},{0,8,11},{8,10,11},
  {3,11,1},{10,11,3},
  {1,10,2},{1,9,10},{9,8,10},
  {3,9,0},{3,10,9},{1,9,2},{2,9,10},
  {0,10,2},{8,10,0},
  {3,10,2},
  {2,8,3},{2,11,8},{11,9,8},
  {9,2,11},{0,2,9},
  {2,8,3},{2,11,8},{0,8,1},{1,8,11},
  {1,2,11},
  {1,8,3},{9,8,1},
  {0,1,9},
  {0,8,3}
};
int MC::mBits[8]={
  0x01,// 0000 0001 i.e. bit 1 is on
  0x02,// 0000 0010 i.e. bit 2 is on
  0x04,// 0000 0100 i.e. bit 3 is on
  0x08,// 0000 1000 i.e. bit 4 is on
  0x10,// 0001 0000 i.e. bit 5 is on
  0x20,// 0010 0000 i.e. bit 6 is on
  0x40,// 0100 0000 i.e. bit 7 is on
  0x80//  1000 0000 i.e. bit 8 is on
};


#endif
